(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[585],{3119:(e,a,t)=>{"use strict";t.d(a,{_:()=>i});var l=t(5704);let i={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBu30v3pgH1S7EwjG_L5x3n04ngD-5VCa8",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"talentvault-446214.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"talentvault-446214",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"talentvault-446214.firebasestorage.app",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"405116036726",NEXT_PUBLIC_FIREBASE_APP_ID:"1:405116036726:web:c73f8b21785ce4b22a6157",NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID:l.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,FIREBASE_PROJECT_ID:l.env.FIREBASE_PROJECT_ID,FIREBASE_CLIENT_EMAIL:l.env.FIREBASE_CLIENT_EMAIL,FIREBASE_PRIVATE_KEY:l.env.FIREBASE_PRIVATE_KEY,stripeSecretKey:l.env.STRIPE_SECRET_KEY||null,stripeWebhookSecret:l.env.STRIPE_WEBHOOK_SECRET||null,stripeUnlockPriceId:l.env.STRIPE_UNLOCK_PRICE_ID||null,stripeSubLimitedPriceId:l.env.STRIPE_SUB_LIMITED_PRICE_ID||null,stripeSubUnlimitedPriceId:l.env.STRIPE_SUB_UNLIMITED_PRICE_ID||null,siteUrl:l.env.NEXT_PUBLIC_SITE_URL||l.env.SITE_URL||"http://localhost:3000"}},3427:(e,a,t)=>{Promise.resolve().then(t.bind(t,7518))},4585:(e,a,t)=>{"use strict";t.d(a,{IG:()=>p,db:()=>u,j2:()=>d});var l=t(2078),i=t(2553),s=t(9708),n=t(9996),r=t(3119);let c={apiKey:r._.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:r._.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:r._.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:r._.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:r._.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:r._.NEXT_PUBLIC_FIREBASE_APP_ID},o=(0,l.Dk)().length?(0,l.Sx)():(0,l.Wp)(c),d=(0,i.xI)(o);(0,i.oM)(d,i.F0);let u=(0,s.aU)(o),p=(0,n.c7)(o)},7518:(e,a,t)=>{"use strict";t.d(a,{default:()=>u});var l=t(5155),i=t(2115),s=t(4405),n=t(4585),r=t(9996),c=t(9708);let o=s.Ikc({id:s.YjP().optional(),title:s.YjP().min(2,"Job title is required"),company:s.YjP().min(2,"Company is required"),start_date:s.YjP().min(4,"Start date is required"),end_date:s.YjP().optional(),is_current:s.zMY().optional(),location:s.YjP().optional(),description:s.YjP().optional()}),d=s.Ikc({full_name:s.YjP().min(2,"Name is required"),headline:s.YjP().min(5,"Headline is required"),summary:s.YjP().optional(),skills:s.YOg(s.YjP()).min(1,"Add at least one skill"),availability:s.YjP().min(2,"Availability is required"),location:s.YjP().min(2,"Location is required"),years_experience:s.aig().int().min(0).max(60).optional(),work_permit_status:s.YjP().optional(),salary_expectation_eur:s.aig().int().min(0).max(1e6).optional(),visibility:s.k5n(["public","employers_only","hidden"]),contact_email:s.YjP().email("Valid contact email required"),phone:s.YjP().optional(),experiences:s.YOg(o).optional()});function u(e){let{userId:a,fullName:t,initialProfile:s,initialContact:o,initialExperiences:u}=e,[m,_]=(0,i.useState)((null==s?void 0:s.skills)||[]),[x,h]=(0,i.useState)(""),[E,j]=(0,i.useState)((null==u?void 0:u.length)?u:[]),[g,b]=(0,i.useState)(null),[v,N]=(0,i.useState)(!1),[y,f]=(0,i.useState)(null),[I,S]=(0,i.useState)(null),P=()=>{let e=x.trim();e&&!m.includes(e)&&(_([...m,e]),h(""))},C=(e,a,t)=>{j(l=>l.map((l,i)=>i===e?{...l,[a]:t}:l))},k=async e=>{e.preventDefault(),N(!0),S(null),f(null);let t=new FormData(e.currentTarget),l={full_name:String(t.get("full_name")||"").trim(),headline:String(t.get("headline")||"").trim(),summary:String(t.get("summary")||"").trim(),availability:String(t.get("availability")||"").trim(),location:String(t.get("location")||"").trim(),years_experience:t.get("years_experience")?Number(t.get("years_experience")):void 0,work_permit_status:String(t.get("work_permit_status")||"").trim()||void 0,salary_expectation_eur:t.get("salary_expectation_eur")?Number(t.get("salary_expectation_eur")):void 0,visibility:t.get("visibility"),contact_email:String(t.get("contact_email")||"").trim(),phone:String(t.get("phone")||"").trim()||void 0,skills:m,experiences:E},i=d.safeParse(l);if(!i.success){var s,u;N(!1),S((null==(u=i.error.issues)||null==(s=u[0])?void 0:s.message)||"Please fix the highlighted issues.");return}let p=n.j2.currentUser;if(!p){N(!1),S("You must be signed in.");return}let _=(null==o?void 0:o.profile_storage_path)||null;try{if(g){if("application/pdf"!==g.type){N(!1),S("Profile must be a PDF file.");return}let e=(0,r.KR)(n.IG,"profile-files/".concat(p.uid,"/").concat(g.name)),a=await (0,r.D)(e,g);_=await (0,r.qk)(a.ref)}await (0,c.BN)((0,c.H9)(n.db,"jobseeker_profiles",a),{id:a,headline:l.headline,summary:l.summary,skills:l.skills,availability:l.availability,location:l.location,years_experience:l.years_experience,visibility:l.visibility,work_permit_status:l.work_permit_status,salary_expectation_eur:l.salary_expectation_eur,updated_at:new Date().toISOString()},{merge:!0}),await (0,c.BN)((0,c.H9)(n.db,"jobseeker_contacts",a),{jobseeker_id:a,contact_email:l.contact_email,phone:l.phone,profile_storage_path:_,updated_at:new Date().toISOString()},{merge:!0}),await (0,c.mZ)((0,c.H9)(n.db,"profiles",a),{full_name:l.full_name,location:l.location,updated_at:new Date().toISOString()});let e=(0,c.P)((0,c.rJ)(n.db,"work_experiences"),(0,c._M)("jobseeker_id","==",a)),t=(await (0,c.GG)(e)).docs.map(e=>(0,c.kd)(e.ref));if(await Promise.all(t),l.experiences&&l.experiences.length>0){let e=l.experiences.map(e=>({jobseeker_id:a,title:e.title,company:e.company,start_date:e.start_date,end_date:e.is_current?null:e.end_date||null,is_current:!!e.is_current,location:e.location,description:e.description})).map(e=>(0,c.gS)((0,c.rJ)(n.db,"work_experiences"),e));await Promise.all(e)}N(!1),f("Profile saved successfully.")}catch(e){N(!1),S(e instanceof Error?e.message:"Something went wrong")}};return(0,l.jsxs)("form",{className:"space-y-6",onSubmit:k,children:[(0,l.jsxs)("div",{className:"card p-6",children:[(0,l.jsx)("p",{className:"text-sm font-semibold uppercase tracking-wide text-blue-700",children:"Jobseeker profile"}),(0,l.jsx)("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Publish your Profile on TalentVault for local employers to discover"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:"Structured profile first; optional PDF upload for completeness."})]}),(0,l.jsxs)("div",{className:"card space-y-4 p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Personal info"}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsx)(p,{label:"Full name",children:(0,l.jsx)("input",{name:"full_name",defaultValue:t,required:!0,className:"input"})}),(0,l.jsx)(p,{label:"Location",children:(0,l.jsx)("input",{name:"location",defaultValue:(null==s?void 0:s.location)||"",required:!0,className:"input"})})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsx)(p,{label:"Contact email",children:(0,l.jsx)("input",{name:"contact_email",type:"email",defaultValue:(null==o?void 0:o.contact_email)||"",required:!0,className:"input"})}),(0,l.jsx)(p,{label:"Phone (optional)",children:(0,l.jsx)("input",{name:"phone",defaultValue:(null==o?void 0:o.phone)||"",className:"input"})})]})]}),(0,l.jsxs)("div",{className:"card space-y-4 p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Profile basics"}),(0,l.jsx)(p,{label:"Headline",children:(0,l.jsx)("input",{name:"headline",defaultValue:(null==s?void 0:s.headline)||"",required:!0,className:"input"})}),(0,l.jsx)(p,{label:"Summary",children:(0,l.jsx)("textarea",{name:"summary",rows:4,defaultValue:(null==s?void 0:s.summary)||"",className:"input"})}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,l.jsx)(p,{label:"Availability",children:(0,l.jsx)("input",{name:"availability",defaultValue:(null==s?void 0:s.availability)||"Immediately",required:!0,className:"input"})}),(0,l.jsx)(p,{label:"Work permit status",children:(0,l.jsx)("input",{name:"work_permit_status",defaultValue:(null==s?void 0:s.work_permit_status)||"",className:"input"})}),(0,l.jsx)(p,{label:"Salary expectation (EUR)",children:(0,l.jsx)("input",{name:"salary_expectation_eur",type:"number",min:0,defaultValue:(null==s?void 0:s.salary_expectation_eur)||"",className:"input"})})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsx)(p,{label:"Years of experience",children:(0,l.jsx)("input",{name:"years_experience",type:"number",min:0,max:60,defaultValue:(null==s?void 0:s.years_experience)||"",className:"input"})}),(0,l.jsx)(p,{label:"Visibility",children:(0,l.jsxs)("select",{name:"visibility",defaultValue:(null==s?void 0:s.visibility)||"public",className:"input",children:[(0,l.jsx)("option",{value:"public",children:"Public"}),(0,l.jsx)("option",{value:"employers_only",children:"Recruiters only"}),(0,l.jsx)("option",{value:"hidden",children:"Hidden"})]})})]})]}),(0,l.jsxs)("div",{className:"card space-y-3 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Skills"}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:"Click a tag to remove"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:m.map(e=>(0,l.jsxs)("span",{className:"badge cursor-pointer",onClick:()=>{_(m.filter(a=>a!==e))},title:"Click to remove",children:[e," âœ•"]},e))}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,l.jsx)("input",{value:x,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),P())},placeholder:"Type a skill and press Enter",className:"input flex-1"}),(0,l.jsx)("button",{type:"button",onClick:P,className:"btn btn-secondary",children:"Add"})]})]}),(0,l.jsxs)("div",{className:"card space-y-4 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Experience"}),(0,l.jsx)("button",{type:"button",onClick:()=>{j([...E,{title:"",company:"",start_date:"",end_date:"",is_current:!1,location:"",description:""}])},className:"btn btn-secondary",children:"Add role"})]}),0===E.length?(0,l.jsx)("p",{className:"text-sm text-slate-600",children:"No experience added yet."}):(0,l.jsx)("div",{className:"space-y-4",children:E.map((e,a)=>{var t,i,s,n;return(0,l.jsxs)("div",{className:"card p-4",children:[(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,l.jsx)(p,{label:"Job title",children:(0,l.jsx)("input",{value:e.title,onChange:e=>C(a,"title",e.target.value),className:"input"})}),(0,l.jsx)(p,{label:"Company",children:(0,l.jsx)("input",{value:e.company,onChange:e=>C(a,"company",e.target.value),className:"input"})})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,l.jsx)(p,{label:"Start date",children:(0,l.jsx)("input",{type:"date",value:null!=(t=e.start_date)?t:"",onChange:e=>C(a,"start_date",e.target.value),className:"input"})}),(0,l.jsx)(p,{label:"End date",children:(0,l.jsx)("input",{type:"date",value:null!=(i=e.end_date)?i:"",onChange:e=>C(a,"end_date",e.target.value),disabled:e.is_current||!1,className:"input"})}),(0,l.jsx)(p,{label:"Current role?",children:(0,l.jsx)("input",{type:"checkbox",checked:!!e.is_current,onChange:e=>C(a,"is_current",e.target.checked),className:"h-4 w-4 accent-blue-700"})})]}),(0,l.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:(0,l.jsx)(p,{label:"Location (optional)",children:(0,l.jsx)("input",{value:null!=(s=e.location)?s:"",onChange:e=>C(a,"location",e.target.value),className:"input"})})}),(0,l.jsx)(p,{label:"Description",children:(0,l.jsx)("textarea",{value:null!=(n=e.description)?n:"",onChange:e=>C(a,"description",e.target.value),rows:3,className:"input"})}),(0,l.jsx)("div",{className:"mt-2 flex justify-end",children:(0,l.jsx)("button",{type:"button",onClick:()=>(e=>{let a=[...E];a.splice(e,1),j(a)})(a),className:"btn btn-secondary text-xs",children:"Remove"})})]},a)})})]}),(0,l.jsxs)("div",{className:"card space-y-4 p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Profile file (optional)"}),(0,l.jsx)("input",{name:"profile_file",type:"file",accept:"application/pdf",onChange:e=>{var a;return b((null==(a=e.target.files)?void 0:a[0])||null)},className:"text-sm text-slate-700"}),(null==o?void 0:o.profile_storage_path)?(0,l.jsxs)("p",{className:"text-xs text-slate-600",children:["Existing file path: ",o.profile_storage_path]}):(0,l.jsx)("p",{className:"text-xs text-slate-600",children:"Upload a PDF file (e.g., your resume) to share on unlock."})]}),I?(0,l.jsx)("p",{className:"text-sm text-red-600",children:I}):null,y?(0,l.jsx)("p",{className:"text-sm text-green-700",children:y}):null,(0,l.jsxs)("div",{className:"card flex items-center justify-between gap-3 p-4",children:[(0,l.jsx)("div",{className:"text-xs text-slate-600",children:"Visibility and contact gating follow your selection and unlock rules."}),(0,l.jsx)("button",{type:"submit",disabled:v,className:"btn btn-primary",children:v?"Saving...":"Save profile"})]})]})}function p(e){let{label:a,children:t}=e;return(0,l.jsxs)("label",{className:"flex flex-col gap-1 text-sm font-medium text-slate-700",children:[a,t]})}}},e=>{e.O(0,[135,563,31,405,441,255,358],()=>e(e.s=3427)),_N_E=e.O()}]);