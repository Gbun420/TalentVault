(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[611],{3119:(e,s,a)=>{"use strict";a.d(s,{_:()=>l});var t=a(5704);let l={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBu30v3pgH1S7EwjG_L5x3n04ngD-5VCa8",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"talentvault-446214.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"talentvault-446214",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"talentvault-446214.firebasestorage.app",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"405116036726",NEXT_PUBLIC_FIREBASE_APP_ID:"1:405116036726:web:c73f8b21785ce4b22a6157",NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID:t.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,FIREBASE_PROJECT_ID:t.env.FIREBASE_PROJECT_ID,FIREBASE_CLIENT_EMAIL:t.env.FIREBASE_CLIENT_EMAIL,FIREBASE_PRIVATE_KEY:t.env.FIREBASE_PRIVATE_KEY,stripeSecretKey:t.env.STRIPE_SECRET_KEY||null,stripeWebhookSecret:t.env.STRIPE_WEBHOOK_SECRET||null,stripeUnlockPriceId:t.env.STRIPE_UNLOCK_PRICE_ID||null,stripeSubLimitedPriceId:t.env.STRIPE_SUB_LIMITED_PRICE_ID||null,stripeSubUnlimitedPriceId:t.env.STRIPE_SUB_UNLIMITED_PRICE_ID||null,siteUrl:t.env.NEXT_PUBLIC_SITE_URL||t.env.SITE_URL||"http://localhost:3000"}},4291:(e,s,a)=>{"use strict";a.d(s,{default:()=>c});var t=a(5155),l=a(2115),i=a(4585),n=a(9708);let r=[{label:"Any",value:""},{label:"0-2 years",value:"0-2"},{label:"3-5 years",value:"3-5"},{label:"6-10 years",value:"6-10"},{label:"10+ years",value:"10+"}];function c(){let[e,s]=(0,l.useState)(""),[a,c]=(0,l.useState)(""),[o,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[x,_]=(0,l.useState)(""),[h,E]=(0,l.useState)(""),[N,b]=(0,l.useState)(!0),[j,v]=(0,l.useState)([]),[I,g]=(0,l.useState)(new Set),[S,f]=(0,l.useState)(null),[y,C]=(0,l.useState)(null),[P,k]=(0,l.useState)(null),[R,T]=(0,l.useState)(null),A=async()=>{b(!0),await Promise.all([U(),B(),w()]),b(!1)},B=async()=>{try{let e=i.j2.currentUser;if(!e)return;let s=(0,n.P)((0,n.rJ)(i.db,"unlocked_contacts"),(0,n._M)("employer_id","==",e.uid)),a=await (0,n.GG)(s),t=new Set(a.docs.map(e=>e.data().jobseeker_id));g(t)}catch(e){console.error("Error fetching unlocks:",e)}},w=async()=>{try{let s=i.j2.currentUser;if(!s)return;let a=(0,n.P)((0,n.rJ)(i.db,"employer_subscriptions"),(0,n._M)("employer_id","==",s.uid),(0,n.My)("updated_at","desc"),(0,n.AB)(1)),t=await (0,n.GG)(a);if(!t.empty){var e;let s=t.docs[0].data(),a={plan_code:s.plan_code,status:s.status,current_period_end:null!=(e=s.current_period_end)?e:null};k(a)}}catch(e){console.error("Error fetching subscription:",e)}},U=async()=>{T(null);try{let s=[];if(e.trim()){let a=e.split(",").map(e=>e.trim()).filter(Boolean);a.length&&s.push((0,n._M)("skills","array-contains-any",a))}if(a.trim()&&s.push((0,n._M)("preferred_roles","array-contains",a.trim())),m.trim()&&s.push((0,n._M)("availability","==",m.trim())),x.trim()&&s.push((0,n._M)("location","==",x.trim())),h.trim()&&s.push((0,n._M)("work_permit_status","==",h.trim())),o){let[e,a]="10+"===o?[10,null]:o.split("-").map(Number);void 0!==e&&s.push((0,n._M)("years_experience",">=",e)),null!==a&&s.push((0,n._M)("years_experience","<=",a))}s.push((0,n._M)("moderation_status","==","approved")),s.push((0,n._M)("visibility","in",["public","employers_only"])),s.push((0,n.AB)(50));let t=(0,n.P)((0,n.rJ)(i.db,"jobseeker_profiles"),...s),l=(await (0,n.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));v(l)}catch(e){T(e instanceof Error?e.message:"Something went wrong"),v([])}},L=async e=>{f(e),T(null);let s=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:"unlock",jobseekerId:e})}),a=await s.json();if(!s.ok){T(a.error||"Failed to unlock contact"),f(null);return}if(a.alreadyUnlocked){let s=new Set(I);s.add(e),g(s),f(null);return}if(a.url){window.location.href=a.url;return}f(null)};(0,l.useEffect)(()=>{A()},[]);let F=async e=>{C(e),T(null);let s=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:"subscription",subscriptionType:e})}),a=await s.json();if(!s.ok){T(a.error||"Failed to start subscription checkout"),C(null);return}a.url?window.location.href=a.url:C(null)},M=async e=>{let s=await fetch("/api/unlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobseekerId:e})}),a=await s.json();if(s.ok){let s=new Set(I);return s.add(e),g(s),f(null),!0}return 402!==s.status&&(T(a.error||"Failed to unlock contact"),f(null),null)};return N?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"card p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/4 mb-4"}),(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/2"})]}),(0,t.jsxs)("div",{className:"card p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/4 mb-4"}),(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,t.jsx)("div",{className:"h-10 bg-slate-200 rounded"}),(0,t.jsx)("div",{className:"h-10 bg-slate-200 rounded"}),(0,t.jsx)("div",{className:"h-10 bg-slate-200 rounded"})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"card p-5 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/2"})]}),(0,t.jsxs)("div",{className:"card p-5 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-slate-200 rounded w-1/2"})]})]})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Access options"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Choose a subscription or pay-per-unlock. Limited plans include a fixed number of unlocks; unlimited provides full monthly access."}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,t.jsx)("button",{onClick:()=>F("limited"),disabled:null!==y,className:"btn btn-primary",children:"limited"===y?"Redirecting...":"Subscribe (Limited unlocks)"}),(0,t.jsx)("button",{onClick:()=>F("unlimited"),disabled:null!==y,className:"btn btn-secondary",children:"unlimited"===y?"Redirecting...":"Subscribe (Unlimited)"}),(0,t.jsx)("p",{className:"text-xs text-slate-600",children:"You can still pay-per-unlock on each Profile card if you prefer."})]}),P?(0,t.jsxs)("p",{className:"mt-2 text-xs text-green-700",children:["Active subscription: ",P.plan_code," (",P.status,")"]}):(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"No active subscription detected."})]}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"Search Profiles"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Search local Profiles. Names and contact are blurred until unlocked."}),(0,t.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-3",children:[(0,t.jsx)(d,{label:"Skills (comma separated)",children:(0,t.jsx)("input",{className:"input",value:e,onChange:e=>s(e.target.value),placeholder:"e.g., React, Node, SQL"})}),(0,t.jsx)(d,{label:"Role / function",children:(0,t.jsx)("input",{className:"input",value:a,onChange:e=>c(e.target.value),placeholder:"e.g., Frontend Developer"})}),(0,t.jsx)(d,{label:"Location",children:(0,t.jsx)("input",{className:"input",value:x,onChange:e=>_(e.target.value),placeholder:"e.g., City, Country"})}),(0,t.jsx)(d,{label:"Availability",children:(0,t.jsx)("input",{className:"input",value:m,onChange:e=>p(e.target.value),placeholder:"Immediately"})}),(0,t.jsx)(d,{label:"Work permit",children:(0,t.jsx)("input",{className:"input",value:h,onChange:e=>E(e.target.value),placeholder:"e.g., EU Citizen, Work Permit"})}),(0,t.jsx)(d,{label:"Experience",children:(0,t.jsx)("select",{className:"input",value:o,onChange:e=>u(e.target.value),children:r.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-3",children:[(0,t.jsx)("button",{onClick:U,disabled:N,className:"btn btn-primary",children:N?"Searching...":"Search"}),(0,t.jsx)("button",{onClick:()=>{s(""),c(""),u(""),p(""),_(""),E(""),U()},className:"btn btn-secondary",children:"Clear filters"})]}),R?(0,t.jsx)("p",{className:"mt-2 text-sm text-red-600",children:R}):null]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[0!==j.length||N?null:(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"No Profiles match these filters yet."}),j.map(e=>{var s,a;let l=I.has(e.id),i=(a=e.full_name,l?a:a?a.split(" ").filter(Boolean).map(e=>e[0]+"•••").join(" "):"Hidden"),n=null!=e.years_experience?"".concat(e.years_experience," yrs"):"N/A";return(0,t.jsxs)("div",{className:"card space-y-3 p-5",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-500",children:i}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:e.headline}),l?(0,t.jsx)("span",{className:"badge bg-green-100 text-green-700",children:"Unlocked"}):(0,t.jsx)("span",{className:"badge bg-slate-200 text-slate-700",children:"Locked"})]}),(0,t.jsxs)("div",{className:"text-right",children:[l?(0,t.jsx)("span",{className:"text-xs font-semibold text-green-700",children:"Contact available"}):(0,t.jsx)("button",{onClick:async()=>{if(f(e.id),(null==P?void 0:P.status)==="active"){let s=await M(e.id);if(!0===s||null===s)return}await L(e.id)},disabled:S===e.id,className:"btn btn-primary text-xs",children:S===e.id?"Unlocking...":"Unlock contact"}),l?null:(0,t.jsx)("p",{className:"mt-1 text-[11px] text-slate-600",children:"Paid unlock or active subscription"})]})]}),(0,t.jsx)("p",{className:"text-sm text-slate-700 line-clamp-3",children:e.summary}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:null==(s=e.skills)?void 0:s.slice(0,8).map(e=>(0,t.jsx)("span",{className:"badge",children:e},e))}),(0,t.jsxs)("div",{className:"grid gap-2 text-xs text-slate-600 sm:grid-cols-3",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:"Experience:"})," ",n]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:"Availability:"})," ",e.availability||"Unknown"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:"Location:"})," ",e.location||"Not specified"]})]}),(0,t.jsxs)("p",{className:"text-xs text-slate-600",children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:"Work permit:"})," ",e.work_permit_status||"Unknown"]}),l?(0,t.jsx)("p",{className:"text-xs text-green-700",children:"Contact unlocked. View details on the candidate page."}):(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Contact details are locked until you unlock or use your subscription."})]},e.id)})]})]})}function d(e){let{label:s,children:a}=e;return(0,t.jsxs)("label",{className:"flex flex-col gap-1 text-sm font-medium text-slate-700",children:[s,a]})}},4585:(e,s,a)=>{"use strict";a.d(s,{IG:()=>m,db:()=>u,j2:()=>o});var t=a(2078),l=a(2553),i=a(9708),n=a(9996),r=a(3119);let c={apiKey:r._.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:r._.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:r._.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:r._.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:r._.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:r._.NEXT_PUBLIC_FIREBASE_APP_ID},d=(0,t.Dk)().length?(0,t.Sx)():(0,t.Wp)(c),o=(0,l.xI)(d);(0,l.oM)(o,l.F0);let u=(0,i.aU)(d),m=(0,n.c7)(d)},7590:(e,s,a)=>{Promise.resolve().then(a.bind(a,4291))}},e=>{e.O(0,[135,563,31,441,255,358],()=>e(e.s=7590)),_N_E=e.O()}]);