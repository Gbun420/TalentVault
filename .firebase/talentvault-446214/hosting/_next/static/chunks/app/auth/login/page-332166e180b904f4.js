(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},2830:(e,t,s)=>{Promise.resolve().then(s.bind(s,8471))},3119:(e,t,s)=>{"use strict";s.d(t,{_:()=>l});var a=s(5704);let l={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyDv9lYC3eW8jSIXmRdLSNO4VuOWMhuyges",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"talentvault-446214.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"talentvault-446214",NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET:"talentvault-446214.firebasestorage.app",NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID:"405116036726",NEXT_PUBLIC_FIREBASE_APP_ID:"1:405116036726:web:c73f8b21785ce4b22a6157",NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID:a.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,FIREBASE_PROJECT_ID:a.env.FIREBASE_PROJECT_ID,FIREBASE_CLIENT_EMAIL:a.env.FIREBASE_CLIENT_EMAIL,FIREBASE_PRIVATE_KEY:a.env.FIREBASE_PRIVATE_KEY,stripeSecretKey:a.env.STRIPE_SECRET_KEY||null,stripeWebhookSecret:a.env.STRIPE_WEBHOOK_SECRET||null,stripeUnlockPriceId:a.env.STRIPE_UNLOCK_PRICE_ID||null,stripeSubLimitedPriceId:a.env.STRIPE_SUB_LIMITED_PRICE_ID||null,stripeSubUnlimitedPriceId:a.env.STRIPE_SUB_UNLIMITED_PRICE_ID||null,siteUrl:a.env.NEXT_PUBLIC_SITE_URL||a.env.SITE_URL||"http://localhost:3000"}},4585:(e,t,s)=>{"use strict";s.d(t,{IG:()=>u,db:()=>_,j2:()=>o});var a=s(2078),l=s(2553),n=s(9708),r=s(9996),i=s(3119);let c={apiKey:i._.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:i._.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:i._.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:i._.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:i._.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:i._.NEXT_PUBLIC_FIREBASE_APP_ID},E=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)(c),o=(0,l.xI)(E);(0,l.oM)(o,l.F0);let _=(0,n.aU)(E),u=(0,r.c7)(E)},8471:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),l=s(2115),n=s(63),r=s(2619),i=s.n(r),c=s(4585);let E={jobseeker:"/jobseeker",employer:"/employer",admin:"/admin"};var o=s(3119),_=s(2553),u=s(9708),I=s(5704);function d(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)().get("redirectTo")||"/",[s,r]=(0,l.useState)(!1),[d,m]=(0,l.useState)(null),[S,h]=(0,l.useState)(!1),[p,x]=(0,l.useState)(!1),[N,R]=(0,l.useState)(""),P=e=>e instanceof Error?e.message:"Something went wrong",T=(0,l.useCallback)(async s=>{let a;console.log("handleRedirect called with userId:",s);let l=(0,u.H9)(c.db,"profiles",s),n=await (0,u.x7)(l);console.log("docSnap.exists():",n.exists()),n.exists()&&console.log("docSnap.data():",n.data()),n.exists()&&(a=n.data().role),console.log("role:",a);let r=t||(a?E[a]:"/");console.log("redirecting to:",a?E[a]:r),e.replace(a?E[a]:r)},[t,e]);(0,l.useEffect)(()=>{if("true"===I.env.NEXT_PUBLIC_E2E_AUTH_BYPASS)return void e.replace("/jobseeker");if((0,_.Pj)(c.j2,window.location.href)){let e=window.localStorage.getItem("emailForSignIn");e||(e=window.prompt("Please provide your email for confirmation")),e&&(0,_.hK)(c.j2,e,window.location.href).then(e=>{window.localStorage.removeItem("emailForSignIn"),e.user&&T(e.user.uid)}).catch(e=>{m(P(e)),r(!1)})}},[T,e]);let A=async e=>{e.preventDefault();let t=new FormData(e.currentTarget),s=String(t.get("email")||"").trim(),a=String(t.get("password")||"");if(m(null),r(!0),S){let e={url:"".concat(o._.siteUrl,"/auth/callback"),handleCodeInApp:!0};(0,_.MN)(c.j2,s,e).then(()=>{window.localStorage.setItem("emailForSignIn",s),x(!0)}).catch(e=>{m(P(e))}).finally(()=>{r(!1)});return}(0,_.x9)(c.j2,s,a).then(e=>{e.user&&T(e.user.uid)}).catch(e=>{m(P(e))}).finally(()=>{r(!1)})};return(0,a.jsx)("div",{className:"flex min-h-[70vh] items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"card w-full max-w-md p-8",children:[(0,a.jsxs)("div",{className:"mb-6 text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Login"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Access your TalentVault account."})]}),p?(0,a.jsx)("p",{className:"text-sm text-green-600 text-center mb-4",children:"A magic link has been sent to your email. Please click it to sign in."}):null,(0,a.jsxs)("form",{className:"space-y-4",onSubmit:A,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Email"}),(0,a.jsx)("input",{name:"email",type:"email",required:!0,className:"input mt-1",defaultValue:N,onChange:e=>R(e.target.value),readOnly:s})]}),!S&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Password"}),(0,a.jsx)("input",{name:"password",type:"password",required:!0,className:"input mt-1"})]}),d?(0,a.jsx)("p",{className:"text-sm text-red-600",children:d}):null,(0,a.jsx)("button",{type:"submit",disabled:s,className:"btn btn-primary w-full",children:s?"Signing in...":"Login"})]}),(0,a.jsx)("div",{className:"mt-4 space-y-2",children:(0,a.jsx)("button",{type:"button",onClick:()=>h(!S),className:"text-sm text-blue-700 hover:underline w-full text-center",children:S?"Use password instead":"Send magic link instead"})}),(0,a.jsxs)("p",{className:"mt-4 text-sm text-center text-slate-600",children:["New here?"," ",(0,a.jsx)(i(),{className:"text-blue-700 hover:underline",href:"/auth/signup",children:"Create an account"})]})]})})}function m(){return(0,a.jsx)(l.Suspense,{fallback:null,children:(0,a.jsx)(d,{})})}}},e=>{e.O(0,[135,563,31,619,441,255,358],()=>e(e.s=2830)),_N_E=e.O()}]);